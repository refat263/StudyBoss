<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø£Ø¯Ù…Ù† | Study Boss</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(to right, #0a1128, #1c2541);
      color: #fff;
      padding: 30px;
      text-align: center;
    }

    h1 {
      color: #FFD700;
      margin-bottom: 30px;
    }

    input, select, button {
      padding: 12px;
      margin: 10px 0;
      border-radius: 10px;
      font-size: 1rem;
      border: none;
      width: 80%;
      max-width: 400px;
    }

    button {
      background: #FFD700;
      color: #0a1128;
      font-weight: bold;
      cursor: pointer;
    }

    .student-info {
      margin-top: 20px;
      background: rgba(255,255,255,0.05);
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 0 10px rgba(0,0,0,0.4);
      display: none;
    }

    label {
      font-weight: bold;
      display: block;
      margin-top: 15px;
      color: #FFD700;
    }
  </style>
</head>
<body>

<h1>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø£Ø¯Ù…Ù†</h1>

<input id="studentCode" placeholder="Ø§Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨" />
<br/>
<button onclick="fetchStudent()">Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨</button>

<div class="student-info" id="infoBox">
  <p><strong>ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…:</strong> <span id="name"></span></p>
  <p><strong>ğŸ“§ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„:</strong> <span id="email"></span></p>
  <p><strong>ğŸ“± Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</strong> <span id="phone"></span></p>
  <p><strong>ğŸ« Ø§Ù„Ù‚Ø³Ù…:</strong> <span id="department"></span></p>
  <p><strong>ğŸ“Œ Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©:</strong> <span id="plan"></span></p>

  <label for="activatePlan">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø®Ø·Ø© Ù„Ù„Ø·Ø§Ù„Ø¨:</label>
  <select id="activatePlan">
    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø®Ø·Ø©</option>
    <option value="Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©">â­ Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</option>
    <option value="Ø®Ø·Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©">ğŸ”¥ Ø®Ø·Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</option>
    <option value="Ø®Ø·Ø© Ø§Ù„Ù…Ø­ØªØ±Ù">ğŸ‘‘ Ø®Ø·Ø© Ø§Ù„Ù…Ø­ØªØ±Ù</option>
  </select>
  <br/>
  <button onclick="activateStudent()">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø®Ø·Ø© ÙˆØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯ÙØ¹</button>
</div>

<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
  import { getDatabase, ref, get, update } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCU7tjQHv0yPO74rAKEAwVjvGGalUmjgBQ",
    authDomain: "study-boss-admin.firebaseapp.com",
    databaseURL: "https://study-boss-admin-default-rtdb.firebaseio.com",
    projectId: "study-boss-admin",
    storageBucket: "study-boss-admin.appspot.com",
    messagingSenderId: "365808693326",
    appId: "1:365808693326:web:df16ee5287a4b4da67d31f"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  window.fetchStudent = async () => {
    const code = document.getElementById("studentCode").value.trim();
    if (!code) return alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨");

    const snapshot = await get(ref(db, "students/" + code));
    if (!snapshot.exists()) return alert("Ø§Ù„Ø·Ø§Ù„Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");

    const data = snapshot.val();
    document.getElementById("name").textContent = data.name;
    document.getElementById("email").textContent = data.email;
    document.getElementById("phone").textContent = data.phone;
    document.getElementById("department").textContent = data.department;
    document.getElementById("plan").textContent = data.selectedPlan;
    document.getElementById("infoBox").style.display = "block";
  };

  window.activateStudent = async () => {
    const code = document.getElementById("studentCode").value.trim();
    const newPlan = document.getElementById("activatePlan").value;

    if (!newPlan) return alert("Ø§Ø®ØªØ§Ø± Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ù„ÙŠ Ù‡ØªÙØ¹Ù„Ù‡Ø§ Ù„Ù„Ø·Ø§Ù„Ø¨");

    await update(ref(db, "students/" + code), {
      isPaid: true,
      activatedPlan: newPlan
    });

    alert("âœ… ØªÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­");
  };
</script>

</body>
</html>
